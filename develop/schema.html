<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>WiredTiger: Schema, Columns, Column Groups, Indices and Projections</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="sorttable.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="wiredtiger.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://wiredtiger.com/"><img alt="Logo" src="LogoFinal-header.png" alt="WiredTiger" /></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Version 10.0.2</span>
   </div>
   <div id="projectbrief"><!-- 10.0.2 --></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<div class="banner">
  <a href="https://github.com/wiredtiger/wiredtiger">Fork me on GitHub</a>
  <a class="last" href="http://groups.google.com/group/wiredtiger-users">Join my user group</a>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('schema.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Schema, Columns, Column Groups, Indices and Projections </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>While many tables have simple key/value pairs for records, WiredTiger also supports more complex data patterns.</p>
<h1><a class="anchor" id="schema_intro"></a>
Tables, rows and columns</h1>
<p>A table is a logical representation of data consisting of cells in rows and columns. For example, a database might have a simple table including an employee identifier, last name and first name, and a salary:</p>
<table class="doxtable">
<tr>
<th>Employee ID</th><th>Last Name</th><th>First Name</th><th>Salary </th></tr>
<tr>
<td>1</td><td>Smith</td><td>Joe</td><td>40000 </td></tr>
<tr>
<td>2</td><td>Jones</td><td>Mary</td><td>50000 </td></tr>
<tr>
<td>3</td><td>Johnson</td><td>Cathy</td><td>44000 </td></tr>
</table>
<p>A row-oriented database would store all of the values for the first employee in the first row, then the next employee's values in the next row, and so on:</p>
<pre>
      1,Smith,Joe,40000
      2,Jones,Mary,50000
      3,Johnson,Cathy,44000
</pre><p>A column-oriented database would store all of the values of a column together, then the values of the next column, and so on:</p>
<pre>
      1,2,3
      Smith,Jones,Johnson
      Joe,Mary,Cathy
      40000,50000,44000
</pre><p>WiredTiger supports both storage formats, and can mix and match the storage of columns within a logical table.</p>
<p>A <em>table</em> in WiredTiger consist of one or more <em>"column groups"</em> that together hold all of the columns in primary key order; and zero or more <em>indices</em> that enable fast lookup of records by columns in orders other than the primary key.</p>
<p>Applications describe the format of their data by supplying a schema to <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a>. This specifies how the application's data can be split into fields and mapped onto rows and columns.</p>
<h1><a class="anchor" id="schema_column_types"></a>
Column types</h1>
<p>By default, WiredTiger works as a traditional key/value store, where the keys and values are raw byte arrays accessed using a <a class="el" href="group__wt.html#struct_w_t___i_t_e_m" title="A raw item of data to be managed, including a pointer to the data and a length.">WT_ITEM</a> structure. Key and value types may also be chosen from a list, or composed of multiple columns with any combination of types. Keys and values may be up to (<code>4GB - 512B</code>) bytes in size.</p>
<p>See <a class="el" href="keyvalue.html">Key/Value pairs</a> for more details on raw key / value items.</p>
<h1><a class="anchor" id="schema_format_types"></a>
Format types</h1>
<p>WiredTiger's uses format strings similar to those specified in the Python struct module to describe the types of columns in a table: <a href="http://docs.python.org/library/struct">http://docs.python.org/library/struct</a></p>
<table class="doxtable">
<tr>
<th>Format</th><th>C Type</th><th>Python type</th><th>Notes </th></tr>
<tr>
<td><code>x</code> </td><td>N/A</td><td>N/A</td><td>pad byte, no associated value </td></tr>
<tr>
<td><code>b</code> </td><td><code>int8_t</code> </td><td><code>int</code> </td><td>signed byte </td></tr>
<tr>
<td><code>B</code> </td><td><code>uint8_t</code> </td><td><code>int</code> </td><td>unsigned byte </td></tr>
<tr>
<td><code>h</code> </td><td><code>int16_t</code> </td><td><code>int</code> </td><td>signed 16-bit </td></tr>
<tr>
<td><code>H</code> </td><td><code>uint16_t</code> </td><td><code>int</code> </td><td>unsigned 16-bit </td></tr>
<tr>
<td><code>i</code> </td><td><code>int32_t</code> </td><td><code>int</code> </td><td>signed 32-bit </td></tr>
<tr>
<td><code>I</code> </td><td><code>uint32_t</code> </td><td><code>int</code> </td><td>unsigned 32-bit </td></tr>
<tr>
<td><code>l</code> </td><td><code>int32_t</code> </td><td><code>int</code> </td><td>signed 32-bit </td></tr>
<tr>
<td><code>L</code> </td><td><code>uint32_t</code> </td><td><code>int</code> </td><td>unsigned 32-bit </td></tr>
<tr>
<td><code>q</code> </td><td><code>int64_t</code> </td><td><code>int</code> </td><td>signed 64-bit </td></tr>
<tr>
<td><code>Q</code> </td><td><code>uint64_t</code> </td><td><code>int</code> </td><td>unsigned 64-bit </td></tr>
<tr>
<td><code>r</code> </td><td><code>uint64_t</code> </td><td><code>int</code> </td><td>record number </td></tr>
<tr>
<td><code>s</code> </td><td><code>char</code>[]</td><td><code>str</code> </td><td>fixed-length string </td></tr>
<tr>
<td><code>S</code> </td><td><code>char</code>[]</td><td><code>str</code> </td><td>NUL-terminated string </td></tr>
<tr>
<td><code>t</code> </td><td><code>uint8_t</code> </td><td><code>int</code> </td><td>fixed-length bit field </td></tr>
<tr>
<td><code>u</code> </td><td><code><a class="el" href="group__wt.html#struct_w_t___i_t_e_m" title="A raw item of data to be managed, including a pointer to the data and a length.">WT_ITEM</a> *</code></td><td><code>bytes</code> </td><td>raw byte array </td></tr>
</table>
<p>The <code>'r'</code> type is used for record number keys in column stores. It is otherwise identical to the <code>'Q'</code> type.</p>
<p>The <code>'s'</code> type is used for fixed-length strings. If it is preceded by a size, that indicates the number of bytes to store; the default is a length of 1 byte.</p>
<p>The <code>'S'</code> type is encoded as a C language string terminated by a NUL character. When preceded by a size, that indicates the maximum number of bytes the string can store. In a string with characters less than the specified size, the remaining bytes are NUL padded. If the supplied string is longer than the specified size, it will be stored without a trailing NUL.</p>
<p>The <code>'t'</code> type is used for fixed-length bit field values. If it is preceded by a size, that indicates the number of bits to store, between 1 and 8. That number of low-order bits will be stored in the table. The default is a size of 1 bit: that is, a boolean. C applications must always use a <code>uint8_t</code> type (or equivalently, <code>unsigned char</code>) for calls to <a class="el" href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c" title="Set the value for the next operation.">WT_CURSOR::set_value</a>, and a pointer to the same for calls to <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01" title="Get the value for the current record.">WT_CURSOR::get_value</a>.</p>
<p>If a bit field value is combined with other types in a packing format, it is equivalent to <code>'B'</code>, and a full byte is used to store it. However, when standing alone in a table or column group, and referenced by a record number (that is, a key format of <code>'r'</code>), the <code>'t'</code> type will be stored in a fixed-length column store. This is an optimized on-disk format for efficient storage of small items. (See <a class="el" href="file_formats.html#file_formats_formats">File formats</a> for further information.) It has an important operational restriction: there is no separate out-of-band value to indicate that deleted records do not exist. Instead, deleted values read back as zero. This means removing a record with <a class="el" href="struct_w_t___c_u_r_s_o_r.html#abbba24fe607fee519c4c9c4669cd4455" title="Remove a record.">WT_CURSOR::remove</a> is equivalent to storing a value of 0 in the record with <a class="el" href="struct_w_t___c_u_r_s_o_r.html#a444cdc0952e7f8d55d23173516c7037f" title="Update an existing record and optionally insert a record.">WT_CURSOR::update</a>. Additionally, creating a record past the end of an object implicitly also creates any missing intermediate records, all with values of 0.</p>
<p>The <code>'u'</code> type is for raw byte arrays: if it appears at the end of a format string (including in the default <code>"u"</code> format for untyped tables), the size is not stored explicitly. When <code>'u'</code> appears within a format string, the size is stored as a 32-bit integer in the same byte order as the rest of the format string, followed by the data.</p>
<p>There is a default collator that gives lexicographic (byte-wise) comparisons, and the default encoding is designed so that lexicographic ordering of encoded keys is usually the expected ordering. For example, the variable-length encoding of integers is designed so that they have the natural integer ordering under the default collator.</p>
<p>See <a class="el" href="packing.html">Packing and Unpacking Data</a> for details of WiredTiger's packing format.</p>
<p>WiredTiger can also be extended with custom collators by implementing the <a class="el" href="struct_w_t___c_o_l_l_a_t_o_r.html" title="The interface implemented by applications to provide custom ordering of records.">WT_COLLATOR</a> interface.</p>
<h1><a class="anchor" id="schema_key_and_value_formats"></a>
Key and value formats</h1>
<p>Every table has a key format and a value format as describe in <a class="el" href="schema.html#schema_column_types">Column types</a>. These types are configured when the table is created by passing <code>key_format</code> and <code>value_format</code> keys to <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a>.</p>
<p>For example, a simple row-store table with strings as both keys and values would be created as follows:</p>
<div class="fragment"><div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;table:mytable&quot;</span>, <span class="stringliteral">&quot;key_format=S,value_format=S&quot;</span>));</div>
</div><!-- fragment --><p> A simple column-store table with strings for values would be created as follows:</p>
<div class="fragment"><div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;table:mytable&quot;</span>, <span class="stringliteral">&quot;key_format=r,value_format=S&quot;</span>));</div>
</div><!-- fragment --> <h1><a class="anchor" id="schema_cursor_formats"></a>
Cursor formats</h1>
<p>Cursors for a table have the same key format as the table itself. The key columns of a cursor are set with <a class="el" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc" title="Set the key for the next operation.">WT_CURSOR::set_key</a> and accessed with <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f" title="Get the key for the current record.">WT_CURSOR::get_key</a>. <a class="el" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc" title="Set the key for the next operation.">WT_CURSOR::set_key</a> is analogous to <code>printf</code>, and takes a list of value in the order the key columns are configured in <code>key_format</code>.</p>
<p>For example, setting the key for a row-store table with strings as keys would be done as follows:</p>
<div class="fragment"><div class="line">        <span class="comment">/* Set the cursor&#39;s string key. */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *key = <span class="stringliteral">&quot;another key&quot;</span>;</div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, key);</div>
</div><!-- fragment --><p> For example, setting the key for a column-store table would be done as follows:</p>
<div class="fragment"><div class="line">        uint64_t recno = 37; <span class="comment">/* Set the cursor&#39;s record number key. */</span></div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, recno);</div>
</div><!-- fragment --><p> A more complex example, setting a composite key for a row-store table where the key_format was <code>"SiH"</code>, would be done as follows:</p>
<div class="fragment"><div class="line">        <span class="comment">/* Set the cursor&#39;s &quot;SiH&quot; format composite key. */</span></div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, <span class="stringliteral">&quot;first&quot;</span>, (int32_t)5, (uint16_t)7);</div>
</div><!-- fragment --><p> The key's values are accessed with <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f" title="Get the key for the current record.">WT_CURSOR::get_key</a>, which is analogous to <code>scanf</code>, and takes a list of pointers to values in the same order:</p>
<div class="fragment"><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *key; <span class="comment">/* Get the cursor&#39;s string key. */</span></div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">get_key</a>(cursor, &amp;key));</div>
</div><!-- fragment --><div class="fragment"><div class="line">        uint64_t recno; <span class="comment">/* Get the cursor&#39;s record number key. */</span></div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">get_key</a>(cursor, &amp;recno));</div>
</div><!-- fragment --><div class="fragment"><div class="line">        <span class="comment">/* Get the cursor&#39;s &quot;SiH&quot; format composite key. */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *first;</div>
<div class="line">        int32_t second;</div>
<div class="line">        uint16_t third;</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">get_key</a>(cursor, &amp;first, &amp;second, &amp;third));</div>
</div><!-- fragment --><p> Cursors for a table have the same value format as the table, unless a projection is configured with <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d" title="Open a new cursor on a data source or duplicate an existing cursor.">WT_SESSION::open_cursor</a>. See <a class="el" href="cursors.html#cursor_projections">Projections</a> for more information.</p>
<p><a class="el" href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c" title="Set the value for the next operation.">WT_CURSOR::set_value</a> is used to set value columns, and <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01" title="Get the value for the current record.">WT_CURSOR::get_value</a> is used to get value columns, in the same way as described for <a class="el" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc" title="Set the key for the next operation.">WT_CURSOR::set_key</a> and <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f" title="Get the key for the current record.">WT_CURSOR::get_key</a>.</p>
<h1><a class="anchor" id="schema_columns"></a>
Columns</h1>
<p>The columns in a table can be assigned names by passing a <code>columns</code> key to <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a>. The column names are assigned first to the columns in the <code>key_format</code>, and then to the columns in <code>value_format</code>. There must be a name for every column, and no column names may be repeated.</p>
<p>For example, a column-store table with an employee ID as the key and three columns (department, salary and first year of employment), might be created as follows:</p>
<div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Create a table with columns: keys are record numbers, values are (string, signed 32-bit</span></div>
<div class="line"><span class="comment">     * integer, unsigned 16-bit integer).</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;table:mytable&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;key_format=r,value_format=SiH,columns=(id,department,salary,year-started)&quot;</span>));</div>
</div><!-- fragment --><p> In this example, the key's column name is <code>id</code>, and the value's column names are <code>department</code>, <code>salary</code>, and <code>year-started</code> (where <code>id</code> maps to the column format <code>r</code>, <code>department</code> maps to the column value format <code>S</code>, <code>salary</code> maps to the value format <code>i</code> and <code>year-started</code> maps to the value format <code>H</code>).</p>
<p>Once the table is created, there is no need to call <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a> during subsequent runs of the application. However, it's worthwhile making the call anyway as it both verifies the table exists and the table schema matches the schema expected by the application.</p>
<h1><a class="anchor" id="schema_column_groups"></a>
Column groups</h1>
<p>Once column names are assigned, they can be used to configure column groups. Column groups are primarily used to define storage in order to tune cache behavior, as each column group is stored in a separate file.</p>
<p>There are two steps involved in setting up column groups: first, pass a list of names for the column groups in the <code>colgroups</code> configuration key to <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a>. Then make a call to <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a> for each column group, using the URI <code>colgroup:&lt;table&gt;:&lt;colgroup name&gt;</code> and a <code>columns</code> key in the configuration. Every column must appear in at least one column group; columns can be listed in multiple column groups, causing the column to be stored in multiple files.</p>
<p>For example, consider the following data being stored in a WiredTiger table:</p>
<div class="fragment"><div class="line"><span class="comment">/* The C struct for the data we are storing in a WiredTiger table. */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">char</span> country[5];</div>
<div class="line">    uint16_t year;</div>
<div class="line">    uint64_t population;</div>
<div class="line">} POP_RECORD;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> POP_RECORD pop_data[] = {{<span class="stringliteral">&quot;AU&quot;</span>, 1900, 4000000}, {<span class="stringliteral">&quot;AU&quot;</span>, 1950, 8267337},</div>
<div class="line">  {<span class="stringliteral">&quot;AU&quot;</span>, 2000, 19053186}, {<span class="stringliteral">&quot;CAN&quot;</span>, 1900, 5500000}, {<span class="stringliteral">&quot;CAN&quot;</span>, 1950, 14011422}, {<span class="stringliteral">&quot;CAN&quot;</span>, 2000, 31099561},</div>
<div class="line">  {<span class="stringliteral">&quot;UK&quot;</span>, 1900, 369000000}, {<span class="stringliteral">&quot;UK&quot;</span>, 1950, 50127000}, {<span class="stringliteral">&quot;UK&quot;</span>, 2000, 59522468}, {<span class="stringliteral">&quot;USA&quot;</span>, 1900, 76212168},</div>
<div class="line">  {<span class="stringliteral">&quot;USA&quot;</span>, 1950, 150697361}, {<span class="stringliteral">&quot;USA&quot;</span>, 2000, 301279593}, {<span class="stringliteral">&quot;&quot;</span>, 0, 0}};</div>
</div><!-- fragment --><p> If we primarily wanted to access the population information by itself, but still wanted population information included when accessing other information, we might store all of the columns in one file, and store an additional copy of the population column in another file:</p>
<div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Create the population table. Keys are record numbers, the format for values is (5-byte</span></div>
<div class="line"><span class="comment">     * string, uint16_t, uint64_t). See ::wiredtiger_struct_pack for details of the format strings.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;table:poptable&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;key_format=r,value_format=5sHQ,columns=(id,country,year,population),colgroups=(main,&quot;</span></div>
<div class="line">      <span class="stringliteral">&quot;population)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Create two column groups: a primary column group with the country code, year and population</span></div>
<div class="line"><span class="comment">     * (named &quot;main&quot;), and a population column group with the population by itself (named</span></div>
<div class="line"><span class="comment">     * &quot;population&quot;).</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:poptable:main&quot;</span>, <span class="stringliteral">&quot;columns=(country,year,population)&quot;</span>));</div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:poptable:population&quot;</span>, <span class="stringliteral">&quot;columns=(population)&quot;</span>));</div>
</div><!-- fragment --><p> Column groups always have the same key as the table. This is particularly useful for column stores, because record numbers are not stored explicitly on disk, so there is no repetition of keys across multiple files. Keys will be replicated in multiple files in the case of row-store column groups.</p>
<p>A cursor can be opened on a column group by passing the column group's URI to the <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d" title="Open a new cursor on a data source or duplicate an existing cursor.">WT_SESSION::open_cursor</a> method. For example, the population can be retrieved from both of the column groups we created:</p>
<div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Open a cursor on the main column group, and return the information for a particular country.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;colgroup:poptable:main&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, 2);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a7e25b2ced2cf3ec68bd5429bf921c79f">search</a>(cursor));</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;country, &amp;year, &amp;population));</div>
<div class="line">    printf(</div>
<div class="line">      <span class="stringliteral">&quot;ID 2: country %s, year %&quot;</span> PRIu16 <span class="stringliteral">&quot;, population %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>, country, year, population);</div>
</div><!-- fragment --><div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Open a cursor on the population column group, and return the population of a particular</span></div>
<div class="line"><span class="comment">     * country.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;colgroup:poptable:population&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, 2);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a7e25b2ced2cf3ec68bd5429bf921c79f">search</a>(cursor));</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;population));</div>
<div class="line">    printf(<span class="stringliteral">&quot;ID 2: population %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>, population);</div>
</div><!-- fragment --><p> Key columns may not be included in the list of columns for a column group. Because column groups always have the same key as the table, key columns for column groups are retrieved using <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f" title="Get the key for the current record.">WT_CURSOR::get_key</a>, not <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01" title="Get the value for the current record.">WT_CURSOR::get_value</a>.</p>
<p>Another example of using column groups is in <a class="el" href="ex_col_store_8c-example.html">ex_col_store.c</a>:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint16_t hour;</div>
<div class="line">    uint16_t pressure;</div>
<div class="line">    uint16_t loc_lat;</div>
<div class="line">    uint16_t loc_long;</div>
<div class="line">    uint8_t temp;</div>
<div class="line">    uint8_t humidity;</div>
<div class="line">    uint8_t wind;</div>
<div class="line">    uint8_t feels_like_temp;</div>
<div class="line">    <span class="keywordtype">char</span> day[5];</div>
<div class="line">    <span class="keywordtype">char</span> country[5];</div>
<div class="line">} WEATHER;</div>
<div class="line"> </div>
</div><!-- fragment --><div class="fragment"><div class="line">    <span class="comment">/* Create a table with columns and colgroups. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, TABLE_NAME,</div>
<div class="line">      <span class="stringliteral">&quot;key_format=r,value_format=&quot;</span> WT_UNCHECKED_STRING(</div>
<div class="line">        HHHHBBBB5S5S) <span class="stringliteral">&quot;,columns=(id,hour,pressure,loc_lat,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;loc_long,temp,humidity,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;wind,feels_like_temp,day,country),colgroups=(day_time,temperature,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;humidity_pressure,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;wind,feels_like_temp,location)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create the colgroups */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:day_time&quot;</span>, <span class="stringliteral">&quot;columns=(hour,day)&quot;</span>));</div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:temperature&quot;</span>, <span class="stringliteral">&quot;columns=(temp)&quot;</span>));</div>
</div><!-- fragment --><p> In this example the hour and day columns are grouped together in one columns group and the temperature column stored in another. This allows a cursor to be opened on a either of these column groups instead of the entire table.</p>
<div class="fragment"><div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;colgroup:weather:temperature&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">while</span> ((ret = cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a0503f16bd8f3d05aa3552f229b3a8e1b">next</a>(cursor)) == 0) {</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;temp));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Update the value from celsius to fahrenheit. Discarding decimals and keeping data simple</span></div>
<div class="line"><span class="comment">         * by type casting to uint8_t.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        temp_in_fahrenheit = (uint8_t)((1.8 * temp) + 32.0);</div>
<div class="line"> </div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c">set_value</a>(cursor, temp_in_fahrenheit);</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a444cdc0952e7f8d55d23173516c7037f">update</a>(cursor));</div>
<div class="line">    }</div>
<div class="line">    scan_end_check(ret == <a class="code" href="group__wt.html#ga3c9e1b494d95cf34404ab7a974af6bf8">WT_NOTFOUND</a>);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aeea071f192cab12245a50fbe71c3460b">close</a>(cursor));</div>
</div><!-- fragment --><p> An operation can then be completed on the values of this column without having to bring the other columns into memory.</p>
<h1><a class="anchor" id="schema_indices"></a>
Indices</h1>
<p>Columns are also used to create and configure indices on tables.</p>
<p>Table indices are automatically updated whenever the table is modified.</p>
<p>Table index cursors are read-only and cannot be used for update operations.</p>
<p>To create a table index, call <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a> using the URI <code>index:&lt;table&gt;:&lt;index name&gt;</code>, listing a column in the configuration.</p>
<p>Continuing the example, we might open an index on the <code>country</code> column:</p>
<div class="fragment"><div class="line">    <span class="comment">/* Create an index with a simple key. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:poptable:country&quot;</span>, <span class="stringliteral">&quot;columns=(country)&quot;</span>));</div>
</div><!-- fragment --><p> Cursors are opened on indices by passing the index's URI to the <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d" title="Open a new cursor on a data source or duplicate an existing cursor.">WT_SESSION::open_cursor</a> method.</p>
<p>Index cursors use the specified index key columns for <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f" title="Get the key for the current record.">WT_CURSOR::get_key</a> and <a class="el" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc" title="Set the key for the next operation.">WT_CURSOR::set_key</a>. For example, we can retrieve information from the <code>country</code> index as follows:</p>
<div class="fragment"><div class="line">    <span class="comment">/* Search in a simple index. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;index:poptable:country&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, <span class="stringliteral">&quot;AU\0\0\0&quot;</span>);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a7e25b2ced2cf3ec68bd5429bf921c79f">search</a>(cursor));</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;country, &amp;year, &amp;population));</div>
<div class="line">    printf(<span class="stringliteral">&quot;AU: country %s, year %&quot;</span> PRIu16 <span class="stringliteral">&quot;, population %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>, country, year, population);</div>
</div><!-- fragment --><p> To create an index with a composite key, specify more than one column to the <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb" title="Create a table, column group, index or file.">WT_SESSION::create</a> call:</p>
<div class="fragment"><div class="line">    <span class="comment">/* Create an index with a composite key (country,year). */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:poptable:country_plus_year&quot;</span>, <span class="stringliteral">&quot;columns=(country,year)&quot;</span>));</div>
</div><!-- fragment --><p> To retrieve information from a composite index requires a more complicated <a class="el" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc" title="Set the key for the next operation.">WT_CURSOR::set_key</a> call, but is otherwise the same:</p>
<div class="fragment"><div class="line">    <span class="comment">/* Search in a composite index. */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;index:poptable:country_plus_year&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, <span class="stringliteral">&quot;USA\0\0&quot;</span>, (uint16_t)1900);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a7e25b2ced2cf3ec68bd5429bf921c79f">search</a>(cursor));</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;country, &amp;year, &amp;population));</div>
<div class="line">    printf(</div>
<div class="line">      <span class="stringliteral">&quot;US 1900: country %s, year %&quot;</span> PRIu16 <span class="stringliteral">&quot;, population %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>, country, year, population);</div>
</div><!-- fragment --> <h1><a class="anchor" id="schema_index_immutable"></a>
Immutable indices</h1>
<p>It is possible to create an index with the <code>immutable</code> configuration setting enabled. This setting tells WiredTiger that the index keys for a record do not change when records are updated. This is an optimization that it saves a remove and insert into the index whenever a value in the primary table is updated.</p>
<p>If immutable is configured when updates should alter the content of the index it is possible to corrupt data.</p>
<p>An example of using an immutable index is:</p>
<div class="fragment"><div class="line">    <span class="comment">/* Create an immutable index. */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:poptable:immutable_year&quot;</span>, <span class="stringliteral">&quot;columns=(year),immutable&quot;</span>));</div>
</div><!-- fragment --> <h1><a class="anchor" id="schema_index_projections"></a>
Index cursor projections</h1>
<p>By default, index cursors return all of the table's value columns from <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01" title="Get the value for the current record.">WT_CURSOR::get_value</a>. The application can specify that a subset of the usual columns should be returned in calls to <a class="el" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01" title="Get the value for the current record.">WT_CURSOR::get_value</a> by appending a list of columns to the <code>uri</code> parameter of the <a class="el" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d" title="Open a new cursor on a data source or duplicate an existing cursor.">WT_SESSION::open_cursor</a> call. This is called a <em>projection</em>, see <a class="el" href="cursors.html#cursor_projections">Projections</a> for more details.</p>
<p>In the case of index cursors, a projection can be used to avoid lookups in column groups that do not hold columns relevant to the operation.</p>
<p>The following example will return just the table's primary key (a record number, in this case) from the index:</p>
<div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Use a projection to return just the table&#39;s record number key from an index.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;index:poptable:country_plus_year(id)&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">while</span> ((ret = cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a0503f16bd8f3d05aa3552f229b3a8e1b">next</a>(cursor)) == 0) {</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">get_key</a>(cursor, &amp;country, &amp;year));</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;recno));</div>
<div class="line">        printf(<span class="stringliteral">&quot;row ID %&quot;</span> PRIu64 <span class="stringliteral">&quot;: country %s, year %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>, recno, country, year);</div>
<div class="line">    }</div>
<div class="line">    scan_end_check(ret == <a class="code" href="group__wt.html#ga3c9e1b494d95cf34404ab7a974af6bf8">WT_NOTFOUND</a>);</div>
</div><!-- fragment --><p> Here is an example of a projection that returns a subset of columns from the index:</p>
<div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Use a projection to return just the population column from an index.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(</div>
<div class="line">      session, <span class="stringliteral">&quot;index:poptable:country_plus_year(population)&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">while</span> ((ret = cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a0503f16bd8f3d05aa3552f229b3a8e1b">next</a>(cursor)) == 0) {</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">get_key</a>(cursor, &amp;country, &amp;year));</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;population));</div>
<div class="line">        printf(<span class="stringliteral">&quot;population %&quot;</span> PRIu64 <span class="stringliteral">&quot;: country %s, year %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>, population, country, year);</div>
<div class="line">    }</div>
<div class="line">    scan_end_check(ret == <a class="code" href="group__wt.html#ga3c9e1b494d95cf34404ab7a974af6bf8">WT_NOTFOUND</a>);</div>
</div><!-- fragment --><p> For performance reasons, it may be desirable to include all columns for a performance-critical operation in an index, so that it is possible to perform index-only lookups where no column group from the table is accessed. In this case, all of the "hot" columns should be included in the index (always list the "real" index key columns first, so they will determine the sort order). Then, open a cursor on the index that doesn't return any value columns, and no column group will be accessed.</p>
<div class="fragment"><div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Use a projection to avoid accessing any other column groups when using an index: supply an</span></div>
<div class="line"><span class="comment">     * empty list of value columns.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;index:poptable:country_plus_year()&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">while</span> ((ret = cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a0503f16bd8f3d05aa3552f229b3a8e1b">next</a>(cursor)) == 0) {</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">get_key</a>(cursor, &amp;country, &amp;year));</div>
<div class="line">        printf(<span class="stringliteral">&quot;country %s, year %&quot;</span> PRIu16 <span class="stringliteral">&quot;\n&quot;</span>, country, year);</div>
<div class="line">    }</div>
<div class="line">    scan_end_check(ret == <a class="code" href="group__wt.html#ga3c9e1b494d95cf34404ab7a974af6bf8">WT_NOTFOUND</a>);</div>
</div><!-- fragment --><p> Index cursors for column-store objects may not be created using the record number as the index key (there is no use for a secondary index on a column-store where the index key is the record number).</p>
<h1><a class="anchor" id="schema_examples"></a>
Code samples</h1>
<p>The code included above was taken from the complete example program <a class="el" href="ex_schema_8c-example.html">ex_schema.c</a>.</p>
<p>Here are other example programs, <a class="el" href="ex_call_center_8c-example.html">ex_call_center.c</a>,</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * In SQL, the tables are described as follows:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * CREATE TABLE Customers(id INTEGER PRIMARY KEY,</span></div>
<div class="line"><span class="comment"> *     name VARCHAR(30), address VARCHAR(50), phone VARCHAR(15))</span></div>
<div class="line"><span class="comment"> * CREATE INDEX CustomersPhone ON Customers(phone)</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * CREATE TABLE Calls(id INTEGER PRIMARY KEY, call_date DATE,</span></div>
<div class="line"><span class="comment"> *     cust_id INTEGER, emp_id INTEGER, call_type VARCHAR(12),</span></div>
<div class="line"><span class="comment"> *     notes VARCHAR(25))</span></div>
<div class="line"><span class="comment"> * CREATE INDEX CallsCustDate ON Calls(cust_id, call_date)</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * In this example, both tables will use record numbers for their IDs, which</span></div>
<div class="line"><span class="comment"> * will be the key.  The C structs for the records are as follows.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Customer records. */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint64_t id;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *address;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *phone;</div>
<div class="line">} CUSTOMER;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Call records. */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint64_t id;</div>
<div class="line">    uint64_t call_date;</div>
<div class="line">    uint64_t cust_id;</div>
<div class="line">    uint64_t emp_id;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *call_type;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *notes;</div>
<div class="line">} CALL;</div>
</div><!-- fragment --><div class="fragment"><div class="line">    error_check(conn-&gt;<a class="code" href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html#adad5965cd4a60f65b5ac01f7ca6d1fc0">open_session</a>(conn, NULL, NULL, &amp;session));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Create the customers table, give names and types to the columns. The columns will be stored</span></div>
<div class="line"><span class="comment">     * in two groups: &quot;main&quot; and &quot;address&quot;, created below.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;table:customers&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;key_format=r,value_format=SSS,columns=(id,name,address,phone),colgroups=(main,address)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create the main column group with value columns except address. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:customers:main&quot;</span>, <span class="stringliteral">&quot;columns=(name,phone)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create the address column group with just the address. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:customers:address&quot;</span>, <span class="stringliteral">&quot;columns=(address)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create an index on the customer table by phone number. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:customers:phone&quot;</span>, <span class="stringliteral">&quot;columns=(phone)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Populate the customers table with some data. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;table:customers&quot;</span>, NULL, <span class="stringliteral">&quot;append&quot;</span>, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">for</span> (custp = cust_sample; custp-&gt;name != NULL; custp++) {</div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c">set_value</a>(cursor, custp-&gt;name, custp-&gt;address, custp-&gt;phone);</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aac90d9fbcc031570f924db55f8a1cee3">insert</a>(cursor));</div>
<div class="line">    }</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aeea071f192cab12245a50fbe71c3460b">close</a>(cursor));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Create the calls table, give names and types to the columns. All the columns will be stored</span></div>
<div class="line"><span class="comment">     * together, so no column groups are declared.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;table:calls&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;key_format=r,value_format=qrrSS,columns=(id,call_date,cust_id,emp_id,call_type,notes)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Create an index on the calls table with a composite key of cust_id and call_date.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:calls:cust_date&quot;</span>, <span class="stringliteral">&quot;columns=(cust_id,call_date)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Populate the calls table with some data. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;table:calls&quot;</span>, NULL, <span class="stringliteral">&quot;append&quot;</span>, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">for</span> (callp = call_sample; callp-&gt;call_type != NULL; callp++) {</div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c">set_value</a>(</div>
<div class="line">          cursor, callp-&gt;call_date, callp-&gt;cust_id, callp-&gt;emp_id, callp-&gt;call_type, callp-&gt;notes);</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aac90d9fbcc031570f924db55f8a1cee3">insert</a>(cursor));</div>
<div class="line">    }</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aeea071f192cab12245a50fbe71c3460b">close</a>(cursor));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * First query: a call arrives. In SQL:</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * SELECT id, name FROM Customers WHERE phone=?</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * Use the cust_phone index, lookup by phone number to fill the customer record. The cursor will</span></div>
<div class="line"><span class="comment">     * have a key format of &quot;S&quot; for a string because the cust_phone index has a single column</span></div>
<div class="line"><span class="comment">     * (&quot;phone&quot;), which is of type &quot;S&quot;.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * Specify the columns we want: the customer ID and the name. This means the cursor&#39;s value</span></div>
<div class="line"><span class="comment">     * format will be &quot;rS&quot;.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, <span class="stringliteral">&quot;index:customers:phone(id,name)&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line">    cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, <span class="stringliteral">&quot;123-456-7890&quot;</span>);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a7e25b2ced2cf3ec68bd5429bf921c79f">search</a>(cursor));</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;cust.id, &amp;cust.name));</div>
<div class="line">    printf(<span class="stringliteral">&quot;Read customer record for %s (ID %&quot;</span> PRIu64 <span class="stringliteral">&quot;)\n&quot;</span>, cust.name, cust.id);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aeea071f192cab12245a50fbe71c3460b">close</a>(cursor));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Next query: get the recent order history. In SQL:</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * SELECT * FROM Calls WHERE cust_id=? ORDER BY call_date DESC LIMIT 3</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * Use the call_cust_date index to find the matching calls. Since it is in increasing order by</span></div>
<div class="line"><span class="comment">     * date for a given customer, we want to start with the last record for the customer and work</span></div>
<div class="line"><span class="comment">     * backwards.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * Specify a subset of columns to be returned. (Note that if these were all covered by the</span></div>
<div class="line"><span class="comment">     * index, the primary would not have to be accessed.) Stop after getting 3 records.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(</div>
<div class="line">      session, <span class="stringliteral">&quot;index:calls:cust_date(cust_id,call_type,notes)&quot;</span>, NULL, NULL, &amp;cursor));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * The keys in the index are (cust_id,call_date) -- we want the largest call date for a given</span></div>
<div class="line"><span class="comment">     * cust_id. Search for (cust_id+1,0), then work backwards.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    cust.id = 1;</div>
<div class="line">    cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">set_key</a>(cursor, cust.id + 1, 0);</div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a8068ddce20d0775f26f6dac6e5eb209c">search_near</a>(cursor, &amp;exact));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * If the table is empty, search_near will return WT_NOTFOUND, else the cursor will be</span></div>
<div class="line"><span class="comment">     * positioned on a matching key if one exists, or an adjacent key if one does not. If the</span></div>
<div class="line"><span class="comment">     * positioned key is equal to or larger than the search key, go back one.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (exact &gt;= 0)</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a43d6664d2f68902aa63f933864242e76">prev</a>(cursor));</div>
<div class="line">    <span class="keywordflow">for</span> (count = 0; count &lt; 3; ++count) {</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">get_value</a>(cursor, &amp;call.cust_id, &amp;call.call_type, &amp;call.notes));</div>
<div class="line">        <span class="keywordflow">if</span> (call.cust_id != cust.id)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        printf(</div>
<div class="line">          <span class="stringliteral">&quot;Call record: customer %&quot;</span> PRIu64 <span class="stringliteral">&quot; (%s: %s)\n&quot;</span>, call.cust_id, call.call_type, call.notes);</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a43d6664d2f68902aa63f933864242e76">prev</a>(cursor));</div>
<div class="line">    }</div>
</div><!-- fragment --><p> and <a class="el" href="ex_col_store_8c-example.html">ex_col_store.c</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint16_t hour;</div>
<div class="line">    uint16_t pressure;</div>
<div class="line">    uint16_t loc_lat;</div>
<div class="line">    uint16_t loc_long;</div>
<div class="line">    uint8_t temp;</div>
<div class="line">    uint8_t humidity;</div>
<div class="line">    uint8_t wind;</div>
<div class="line">    uint8_t feels_like_temp;</div>
<div class="line">    <span class="keywordtype">char</span> day[5];</div>
<div class="line">    <span class="keywordtype">char</span> country[5];</div>
<div class="line">} WEATHER;</div>
<div class="line"> </div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html">WT_CONNECTION</a> *conn;</div>
<div class="line">    <a class="code" href="struct_w_t___c_u_r_s_o_r.html">WT_CURSOR</a> *cursor;</div>
<div class="line">    <a class="code" href="struct_w_t___s_e_s_s_i_o_n.html">WT_SESSION</a> *session;</div>
<div class="line">    WEATHER weather_data[NUM_ENTRIES];</div>
<div class="line">    <span class="keywordtype">char</span> countries[][NUM_COUNTRIES - 1] = {<span class="stringliteral">&quot;AUS&quot;</span>, <span class="stringliteral">&quot;GBR&quot;</span>, <span class="stringliteral">&quot;USA&quot;</span>, <span class="stringliteral">&quot;NZD&quot;</span>, <span class="stringliteral">&quot;IND&quot;</span>, <span class="stringliteral">&quot;CHI&quot;</span>, <span class="stringliteral">&quot;RUS&quot;</span>};</div>
<div class="line">    <span class="keywordtype">int</span> max_temp_result, min_temp_result, ret;</div>
<div class="line">    uint16_t ending_time, starting_time;</div>
<div class="line"> </div>
<div class="line">    home = example_setup(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Establishing a connection. */</span></div>
<div class="line">    error_check(<a class="code" href="group__wt.html#gacbe8d118f978f5bfc8ccb4c77c9e8813">wiredtiger_open</a>(home, NULL, <span class="stringliteral">&quot;create,statistics=(fast)&quot;</span>, &amp;conn));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Establishing a session. */</span></div>
<div class="line">    error_check(conn-&gt;<a class="code" href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html#adad5965cd4a60f65b5ac01f7ca6d1fc0">open_session</a>(conn, NULL, NULL, &amp;session));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create a table with columns and colgroups. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, TABLE_NAME,</div>
<div class="line">      <span class="stringliteral">&quot;key_format=r,value_format=&quot;</span> WT_UNCHECKED_STRING(</div>
<div class="line">        HHHHBBBB5S5S) <span class="stringliteral">&quot;,columns=(id,hour,pressure,loc_lat,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;loc_long,temp,humidity,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;wind,feels_like_temp,day,country),colgroups=(day_time,temperature,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;humidity_pressure,&quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;wind,feels_like_temp,location)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create the colgroups */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:day_time&quot;</span>, <span class="stringliteral">&quot;columns=(hour,day)&quot;</span>));</div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:temperature&quot;</span>, <span class="stringliteral">&quot;columns=(temp)&quot;</span>));</div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(</div>
<div class="line">      session, <span class="stringliteral">&quot;colgroup:weather:humidity_pressure&quot;</span>, <span class="stringliteral">&quot;columns=(pressure,humidity)&quot;</span>));</div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:wind&quot;</span>, <span class="stringliteral">&quot;columns=(wind)&quot;</span>));</div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:feels_like_temp&quot;</span>, <span class="stringliteral">&quot;columns=(feels_like_temp)&quot;</span>));</div>
<div class="line">    error_check(</div>
<div class="line">      session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;colgroup:weather:location&quot;</span>, <span class="stringliteral">&quot;columns=(loc_lat,loc_long,country)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Generating random data to populate the weather table. */</span></div>
<div class="line">    generate_data(weather_data);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Open a cursor on the table to insert the data. */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">open_cursor</a>(session, TABLE_NAME, NULL, <span class="stringliteral">&quot;append&quot;</span>, &amp;cursor));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NUM_ENTRIES; i++) {</div>
<div class="line">        cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c">set_value</a>(cursor, weather_data[i].hour, weather_data[i].pressure,</div>
<div class="line">          weather_data[i].loc_lat, weather_data[i].loc_long, weather_data[i].temp,</div>
<div class="line">          weather_data[i].humidity, weather_data[i].wind, weather_data[i].feels_like_temp,</div>
<div class="line">          weather_data[i].day, weather_data[i].country);</div>
<div class="line">        error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aac90d9fbcc031570f924db55f8a1cee3">insert</a>(cursor));</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Close cursor. */</span></div>
<div class="line">    error_check(cursor-&gt;<a class="code" href="struct_w_t___c_u_r_s_o_r.html#aeea071f192cab12245a50fbe71c3460b">close</a>(cursor));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Prints all the data in the database. */</span></div>
<div class="line">    print_all_columns(session);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create indexes for searching */</span></div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:weather:hour&quot;</span>, <span class="stringliteral">&quot;columns=(hour)&quot;</span>));</div>
<div class="line">    error_check(session-&gt;<a class="code" href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">create</a>(session, <span class="stringliteral">&quot;index:weather:country&quot;</span>, <span class="stringliteral">&quot;columns=(country)&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Start and end points for time range for finding min/max temperature, in 24 hour format.</span></div>
<div class="line"><span class="comment">     * Example uses 10am - 8pm but can change the values for desired start and end times.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    starting_time = 1000;</div>
<div class="line">    ending_time = 2000;</div>
<div class="line">    min_temp_result = 0;</div>
<div class="line">    max_temp_result = 0;</div>
<div class="line">    ret = find_min_and_max_temp(</div>
<div class="line">      session, starting_time, ending_time, &amp;min_temp_result, &amp;max_temp_result);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* If the min/max temperature is not found due to some error, there is no result to print. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;The minimum temperature between %&quot;</span> PRIu16 <span class="stringliteral">&quot; and %&quot;</span> PRIu16 <span class="stringliteral">&quot; is %d.\n&quot;</span>,</div>
<div class="line">          starting_time, ending_time, min_temp_result);</div>
<div class="line">        printf(<span class="stringliteral">&quot;The maximum temperature between %&quot;</span> PRIu16 <span class="stringliteral">&quot; and %&quot;</span> PRIu16 <span class="stringliteral">&quot; is %d.\n&quot;</span>,</div>
<div class="line">          starting_time, ending_time, max_temp_result);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Update the temperature from Celsius to Fahrenheit. */</span></div>
<div class="line">    update_celsius_to_fahrenheit(session);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Start and end points for time range for finding min/max temperature, in 24 hour format.</span></div>
<div class="line"><span class="comment">     * Example uses 10am - 8pm but can change the values for desired start and end times.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    starting_time = 1000;</div>
<div class="line">    ending_time = 2000;</div>
<div class="line">    min_temp_result = 0;</div>
<div class="line">    max_temp_result = 0;</div>
<div class="line">    ret = find_min_and_max_temp(</div>
<div class="line">      session, starting_time, ending_time, &amp;min_temp_result, &amp;max_temp_result);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* If the min/max temperature is not found due to some error, there is no result to print. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;The minimum temperature between %&quot;</span> PRIu16 <span class="stringliteral">&quot; and %&quot;</span> PRIu16 <span class="stringliteral">&quot; is %d.\n&quot;</span>,</div>
<div class="line">          starting_time, ending_time, min_temp_result);</div>
<div class="line">        printf(<span class="stringliteral">&quot;The maximum temperature between %&quot;</span> PRIu16 <span class="stringliteral">&quot; and %&quot;</span> PRIu16 <span class="stringliteral">&quot; is %d.\n&quot;</span>,</div>
<div class="line">          starting_time, ending_time, max_temp_result);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Average for all countries:\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NUM_COUNTRIES; i++)</div>
<div class="line">        average_data(session, countries[i]);</div>
<div class="line"> </div>
<div class="line">    remove_country(session);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Average for all countries:\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NUM_COUNTRIES; i++)</div>
<div class="line">        average_data(session, countries[i]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Close the connection. */</span></div>
<div class="line">    error_check(conn-&gt;<a class="code" href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html#af535c517df851eeac8ebf3594d40b545">close</a>(conn, NULL));</div>
<div class="line">    <span class="keywordflow">return</span> (EXIT_SUCCESS);</div>
<div class="line">}</div>
<div class="line"> </div>
</div><!-- fragment --></div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_a43d6664d2f68902aa63f933864242e76"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#a43d6664d2f68902aa63f933864242e76">WT_CURSOR::prev</a></div><div class="ttdeci">int prev(WT_CURSOR *cursor)</div><div class="ttdoc">Return the previous record.</div></div>
<div class="ttc" id="astruct_w_t___s_e_s_s_i_o_n_html_a358ca4141d59c345f401c58501276bbb"><div class="ttname"><a href="struct_w_t___s_e_s_s_i_o_n.html#a358ca4141d59c345f401c58501276bbb">WT_SESSION::create</a></div><div class="ttdeci">int create(WT_SESSION *session, const char *name, const char *config)</div><div class="ttdoc">Create a table, column group, index or file.</div></div>
<div class="ttc" id="astruct_w_t___s_e_s_s_i_o_n_html_afb5b4a69c2c5cafe411b2b04fdc1c75d"><div class="ttname"><a href="struct_w_t___s_e_s_s_i_o_n.html#afb5b4a69c2c5cafe411b2b04fdc1c75d">WT_SESSION::open_cursor</a></div><div class="ttdeci">int open_cursor(WT_SESSION *session, const char *uri, WT_CURSOR *to_dup, const char *config, WT_CURSOR **cursorp)</div><div class="ttdoc">Open a new cursor on a data source or duplicate an existing cursor.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_af19f6f9d9c7fc248ab38879032620b2f"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#af19f6f9d9c7fc248ab38879032620b2f">WT_CURSOR::get_key</a></div><div class="ttdeci">int get_key(WT_CURSOR *cursor,...)</div><div class="ttdoc">Get the key for the current record.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html">WT_CURSOR</a></div><div class="ttdoc">A WT_CURSOR handle is the interface to a cursor.</div><div class="ttdef"><b>Definition:</b> wiredtiger.in:199</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_a7e25b2ced2cf3ec68bd5429bf921c79f"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#a7e25b2ced2cf3ec68bd5429bf921c79f">WT_CURSOR::search</a></div><div class="ttdeci">int search(WT_CURSOR *cursor)</div><div class="ttdoc">Return the record matching the key.</div></div>
<div class="ttc" id="astruct_w_t___c_o_n_n_e_c_t_i_o_n_html_adad5965cd4a60f65b5ac01f7ca6d1fc0"><div class="ttname"><a href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html#adad5965cd4a60f65b5ac01f7ca6d1fc0">WT_CONNECTION::open_session</a></div><div class="ttdeci">int open_session(WT_CONNECTION *connection, WT_EVENT_HANDLER *event_handler, const char *config, WT_SESSION **sessionp)</div><div class="ttdoc">Open a session.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_a0503f16bd8f3d05aa3552f229b3a8e1b"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#a0503f16bd8f3d05aa3552f229b3a8e1b">WT_CURSOR::next</a></div><div class="ttdeci">int next(WT_CURSOR *cursor)</div><div class="ttdoc">Return the next record.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_af85364a5af50b95bbc46c82e72f75c01"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#af85364a5af50b95bbc46c82e72f75c01">WT_CURSOR::get_value</a></div><div class="ttdeci">int get_value(WT_CURSOR *cursor,...)</div><div class="ttdoc">Get the value for the current record.</div></div>
<div class="ttc" id="astruct_w_t___c_o_n_n_e_c_t_i_o_n_html"><div class="ttname"><a href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html">WT_CONNECTION</a></div><div class="ttdoc">A connection to a WiredTiger database.</div><div class="ttdef"><b>Definition:</b> wiredtiger.in:2040</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_a8068ddce20d0775f26f6dac6e5eb209c"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#a8068ddce20d0775f26f6dac6e5eb209c">WT_CURSOR::search_near</a></div><div class="ttdeci">int search_near(WT_CURSOR *cursor, int *exactp)</div><div class="ttdoc">Return the record matching the key if it exists, or an adjacent record.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_aeea071f192cab12245a50fbe71c3460b"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#aeea071f192cab12245a50fbe71c3460b">WT_CURSOR::close</a></div><div class="ttdeci">int close(WT_CURSOR *cursor)</div><div class="ttdoc">Close the cursor.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_a27f7cbd0cd3e561f6a145704813ad64c"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#a27f7cbd0cd3e561f6a145704813ad64c">WT_CURSOR::set_value</a></div><div class="ttdeci">void set_value(WT_CURSOR *cursor,...)</div><div class="ttdoc">Set the value for the next operation.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_a444cdc0952e7f8d55d23173516c7037f"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#a444cdc0952e7f8d55d23173516c7037f">WT_CURSOR::update</a></div><div class="ttdeci">int update(WT_CURSOR *cursor)</div><div class="ttdoc">Update an existing record and optionally insert a record.</div></div>
<div class="ttc" id="agroup__wt_html_gacbe8d118f978f5bfc8ccb4c77c9e8813"><div class="ttname"><a href="group__wt.html#gacbe8d118f978f5bfc8ccb4c77c9e8813">wiredtiger_open</a></div><div class="ttdeci">int wiredtiger_open(const char *home, WT_EVENT_HANDLER *event_handler, const char *config, WT_CONNECTION **connectionp)</div><div class="ttdoc">Open a connection to a database.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_ad1088d719df40babc1f57d086691ebdc"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#ad1088d719df40babc1f57d086691ebdc">WT_CURSOR::set_key</a></div><div class="ttdeci">void set_key(WT_CURSOR *cursor,...)</div><div class="ttdoc">Set the key for the next operation.</div></div>
<div class="ttc" id="agroup__wt_html_ga3c9e1b494d95cf34404ab7a974af6bf8"><div class="ttname"><a href="group__wt.html#ga3c9e1b494d95cf34404ab7a974af6bf8">WT_NOTFOUND</a></div><div class="ttdeci">#define WT_NOTFOUND</div><div class="ttdoc">Item not found.</div><div class="ttdef"><b>Definition:</b> wiredtiger.in:3826</div></div>
<div class="ttc" id="astruct_w_t___s_e_s_s_i_o_n_html"><div class="ttname"><a href="struct_w_t___s_e_s_s_i_o_n.html">WT_SESSION</a></div><div class="ttdoc">All data operations are performed in the context of a WT_SESSION.</div><div class="ttdef"><b>Definition:</b> wiredtiger.in:751</div></div>
<div class="ttc" id="astruct_w_t___c_o_n_n_e_c_t_i_o_n_html_af535c517df851eeac8ebf3594d40b545"><div class="ttname"><a href="struct_w_t___c_o_n_n_e_c_t_i_o_n.html#af535c517df851eeac8ebf3594d40b545">WT_CONNECTION::close</a></div><div class="ttdeci">int close(WT_CONNECTION *connection, const char *config)</div><div class="ttdoc">Close a connection.</div></div>
<div class="ttc" id="astruct_w_t___c_u_r_s_o_r_html_aac90d9fbcc031570f924db55f8a1cee3"><div class="ttname"><a href="struct_w_t___c_u_r_s_o_r.html#aac90d9fbcc031570f924db55f8a1cee3">WT_CURSOR::insert</a></div><div class="ttdeci">int insert(WT_CURSOR *cursor)</div><div class="ttdoc">Insert a record and optionally update an existing record.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Reference Guide</a></li><li class="navelem"><a class="el" href="programming.html">Writing WiredTiger applications</a></li>
    <li class="footer">Copyright (c) 2008-present MongoDB, Inc.  All rights reserved.  Contact <a href="mailto:info@wiredtiger.com">info@wiredtiger.com</a> for more information.</li>
  </ul>
</div>
</body>
</html>
